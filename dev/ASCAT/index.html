<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ASCAT · MetopDatasets.jl</title><meta name="title" content="ASCAT · MetopDatasets.jl"/><meta property="og:title" content="ASCAT · MetopDatasets.jl"/><meta property="twitter:title" content="ASCAT · MetopDatasets.jl"/><meta name="description" content="Documentation for MetopDatasets.jl."/><meta property="og:description" content="Documentation for MetopDatasets.jl."/><meta property="twitter:description" content="Documentation for MetopDatasets.jl."/><meta property="og:url" content="https://eumetsat.github.io/MetopDatasets.jl/ASCAT/"/><meta property="twitter:url" content="https://eumetsat.github.io/MetopDatasets.jl/ASCAT/"/><link rel="canonical" href="https://eumetsat.github.io/MetopDatasets.jl/ASCAT/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MetopDatasets.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../MetopDataset/">MetopDataset</a></li><li><a class="tocitem" href="../python/">Use with Python</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>ASCAT</a><ul class="internal"><li><a class="tocitem" href="#ASCAT"><span>ASCAT</span></a></li><li><a class="tocitem" href="#SZF-beam-statistics"><span>SZF beam statistics</span></a></li><li><a class="tocitem" href="#SZR-and-SZO-plot"><span>SZR and SZO plot</span></a></li><li><a class="tocitem" href="#Soil-moisture-example"><span>Soil moisture example</span></a></li></ul></li><li><a class="tocitem" href="../IASI/">IASI</a></li></ul></li><li><a class="tocitem" href="../full_api/">Full API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>ASCAT</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ASCAT</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/eumetsat/MetopDatasets.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/eumetsat/MetopDatasets.jl/blob/main/docs/src/ASCAT.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="ASCAT"><a class="docs-heading-anchor" href="#ASCAT">ASCAT</a><a id="ASCAT-1"></a><a class="docs-heading-anchor-permalink" href="#ASCAT" title="Permalink"></a></h2><p>The Advanced Scatterometer (ASCAT) is an instrument on the METOP satellites. It is a fixed beam C-band scatterometer with 6 antenna beams used to retrieve wind vectors over the ocean and soil moisture over the land. The level 1 products are normalised backscatter coefficients (sigma0) that the instrument measures directly. The level 2 products are soil moisture and wind vectors derived from the backscatter. The wind vector product does not use the native binary format so they are not described further here. It should be noted that the winds are available as NetCDF. For more information see <a href="https://user.eumetsat.int/s3/eup-strapi-media/ASCAT_User_Guide_1618a3d741.pdf">ASCAT User Guide</a></p><p>All data used in examples are available from <a href="https://data.eumetsat.int/extended?query=&amp;filter=instrument__ASCAT&amp;filter=availableFormats__EPS%20Native">EUMETSAT data store</a></p><h2 id="SZF-beam-statistics"><a class="docs-heading-anchor" href="#SZF-beam-statistics">SZF beam statistics</a><a id="SZF-beam-statistics-1"></a><a class="docs-heading-anchor-permalink" href="#SZF-beam-statistics" title="Permalink"></a></h2><p>The level 1B SZF files contain full resolution backscatter from the 6 antenna beams. See the <a href="https://data.eumetsat.int/product/EO:EUM:DAT:METOP:ASCSZF1B">ASCAT level 1B SZF product page</a> for more information.   This example shows how we can get the 5% and 95% quantile of the backscatter from each beam only considering the observations with no flags. It should be noted that observations over land are are flagged with a land-flag so theses statistics only consider oceans.</p><p>Read and inspect the variables:</p><pre><code class="language-julia hljs">using MetopDatasets, Statistics
ds = MetopDataset(&quot;ASCA_SZF_1B_M03_20241217091500Z_20241217105659Z_N_O_20241217105652Z.nat&quot;)

# Read arrays immediately
beam_numbers = Array(ds[&quot;beam_number&quot;])
sigma0 = Array(ds[&quot;sigma0_full&quot;])
flags = Array(ds[&quot;flagfield&quot;])

@show size(beam_numbers)
@show size(sigma0)
@show size(flags)

no_flags = flags .== 0 
println(&quot;Number of observations with no flag: &quot;, sum(no_flags))</code></pre><p>REPL output:</p><pre><code class="nohighlight hljs">size(beam_numbers) = (43236,)
size(sigma0) = (192, 43236)  
size(flags) = (192, 43236)
Number of observations with no flag: 5948489</code></pre><p>We can see that <code>beam_numbers</code> only have 1 dimension but <code>sigma0</code> and <code>flags</code> have two. This is because there is only one beam number per data record but each data record contain a line with 192 observations across the swath.  Printing the quantiles for each beam.</p><pre><code class="language-julia hljs">for i in 1:6 # same as `i in sort(unique(beam_numbers))`
    in_beam = beam_numbers .== i
    sigma0_beam = sigma0[:, in_beam]
    no_flags_beam = no_flags[:, in_beam]

    sigma_q05 = quantile(sigma0_beam[no_flags_beam],0.05)
    sigma_q95 = quantile(sigma0_beam[no_flags_beam],0.95)

    rounded_range = round.((sigma_q05,sigma_q95); digits=2) 

    println(&quot;Beam: &quot;, i, &quot;, Sigma0 (q05,q95) range: &quot;, rounded_range )
end</code></pre><p>REPL output:</p><pre><code class="nohighlight hljs">Beam: 1, Sigma0 (q05,q95) range: (-29.84, -12.31)
Beam: 2, Sigma0 (q05,q95) range: (-27.22, -5.63)
Beam: 3, Sigma0 (q05,q95) range: (-29.94, -12.76)
Beam: 4, Sigma0 (q05,q95) range: (-28.75, -12.96)
Beam: 5, Sigma0 (q05,q95) range: (-25.5, -5.2)
Beam: 6, Sigma0 (q05,q95) range: (-28.4, -12.02)</code></pre><p>We can now see the sigma0 quintile ranges for each beam.</p><h2 id="SZR-and-SZO-plot"><a class="docs-heading-anchor" href="#SZR-and-SZO-plot">SZR and SZO plot</a><a id="SZR-and-SZO-plot-1"></a><a class="docs-heading-anchor-permalink" href="#SZR-and-SZO-plot" title="Permalink"></a></h2><p>The level 1B SZR files contain backscatter values from the 6 ASCAT beams, resampled to a common 12.5 x 12.5 km grid. There are three beams imaging each side of the satellite so this results in 3 backscatter measurements for each grid point. The level 1B SZO files are identical but resampled to a 25 x 25 km grid instead. See <a href="https://data.eumetsat.int/product/EO:EUM:DAT:METOP:ASCSZR1B">ASCAT level 1B SZR product page</a> and <a href="https://data.eumetsat.int/product/EO:EUM:DAT:METOP:ASCSZO1B">ASCAT level 1B SZO product page</a> for more information.</p><p>These examples will work to both plot SZR and SZO data. The examples are made using the following packages.</p><pre><code class="nohighlight hljs">[13f3f980] CairoMakie v0.12.16
[db073c08] GeoMakie v0.7.9</code></pre><p>Note that the plot can become interactive by replacing CarioMakie with GLMakie. See <a href="https://docs.makie.org/">Makie documentation</a> for more information on plotting.</p><h3 id="Global-plot-of-SZR-or-SZO"><a class="docs-heading-anchor" href="#Global-plot-of-SZR-or-SZO">Global plot of SZR or SZO</a><a id="Global-plot-of-SZR-or-SZO-1"></a><a class="docs-heading-anchor-permalink" href="#Global-plot-of-SZR-or-SZO" title="Permalink"></a></h3><p>This example plots the backscatter from and entire orbit. The backscatter is just plotted for one beam direction. </p><pre><code class="language-julia hljs">using MetopDatasets
using CairoMakie, GeoMakie, Statistics

# Open the dataset
ds = MetopDataset(&quot;ASCA_SZR_1B_M01_20241217081500Z_20241217095658Z_N_O_20241217090832Z.nat&quot;, maskingvalue=NaN);

# Select which beam to plot 
beam_names = [&quot;fore-beam&quot;, &quot;mid-beam&quot;, &quot;aft-beam&quot;]
beam_index = 3

# read variables for beam
latitude = Array(ds[&quot;latitude&quot;])
longitude = Array(ds[&quot;longitude&quot;])
sigma0 = ds[&quot;sigma0_trip&quot;][beam_index,:,:]
usable_flag = ds[&quot;f_usable&quot;][beam_index,:,:]

# change longitude to be -180 to 180
longitude[longitude .&gt; 180] .-= 360

# check flags
usable = usable_flag .!= 2

# get sigma0 ranges
sigma_q05 = quantile(sigma0[usable],0.05)
sigma_q95 = quantile(sigma0[usable],0.95)

# plot the data
fig = let

    # Create figure and axis
    fig = Figure()
    ax = GeoAxis(fig[1, 1],
        title = &quot;Backscatter for &quot; * beam_names[beam_index],
        xlabel = &quot;longitude&quot;,
        ylabel = &quot;latitude&quot;)

    # plot &quot;good&quot; and &quot;usable&quot; data with color map
    scatter!(ax, longitude[usable], latitude[usable],
        color = sigma0[usable], colorrange = (sigma_q05,sigma_q95), markersize = 1)

    # plot &quot;bad&quot; data as red
    scatter!(ax, longitude[.!usable], latitude[.!usable],
        color = :red, markersize = 1)

    # Add colorbar
    Colorbar(fig[1,2], colorrange = (sigma_q05,sigma_q95), label=&quot;dB&quot;)

    # Add coastlines
    lines!(ax, GeoMakie.coastlines()) 
    fig
end</code></pre><p><img src="../global_szr_plot.png" alt="Global SZR plot"/></p><p>The plot shows the left and right swath ASCAT mapped for an orbit. </p><h3 id="Plotting-a-subset-of-SZR-or-SZO"><a class="docs-heading-anchor" href="#Plotting-a-subset-of-SZR-or-SZO">Plotting a subset of SZR or SZO</a><a id="Plotting-a-subset-of-SZR-or-SZO-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-a-subset-of-SZR-or-SZO" title="Permalink"></a></h3><p>This example shows how to plot the backscatter for a small subset of the SZR product.</p><pre><code class="language-julia hljs">using MetopDatasets
using CairoMakie, GeoMakie, Statistics

ds = MetopDataset(&quot;ASCA_SZR_1B_M01_20241217081500Z_20241217095658Z_N_O_20241217090832Z.nat&quot;, maskingvalue=NaN);

# Select subset record subset to plot
record_subset = 150:350

# define the two swaths. 
grid_nodes = ds.dim[&quot;xtrack&quot;]
swath_width = div(grid_nodes,2)
left_swath = 1:swath_width
right_swath = (swath_width+1):grid_nodes

# read variables for right_swath of the subset.
latitude = ds[&quot;latitude&quot;][right_swath, record_subset]
longitude = ds[&quot;longitude&quot;][right_swath, record_subset]
sigma0 = ds[&quot;sigma0_trip&quot;][:, right_swath, record_subset]
usable_flag = ds[&quot;f_usable&quot;][:, right_swath, record_subset]

# change longitude to be -180 to 180
longitude[longitude .&gt; 180] .-= 360

# check flags
usable = usable_flag .!= 2

# get sigma0 ranges
sigma_q05 = quantile(sigma0[usable],0.05)
sigma_q95 = quantile(sigma0[usable],0.95)

# plot the data
beam_names = [&quot;fore-beam&quot;, &quot;mid-beam&quot;, &quot;aft-beam&quot;]
fig = let    
    fig = Figure()

    # plot each beam
    for i in 1:3
        sigma_i = sigma0[i,:,:]
        usable_i = usable[i,:,:]

        # Create new axis
        ax = GeoAxis(fig[1, i],
            title = beam_names[i],
            xlabel = &quot;longitude&quot;,
            ylabel = &quot;latitude&quot;,
            limits = (extrema(longitude), extrema(latitude))
            )

        # plot &quot;good&quot; and &quot;usable&quot; data with color map
        scatter!(ax, longitude[usable_i], latitude[usable_i],
            color = sigma_i[usable_i], colorrange = (sigma_q05,sigma_q95), markersize = 6)
        
        # plot &quot;bad&quot; data as red
        scatter!(ax, longitude[.!usable_i], latitude[.!usable_i],
            color = :red, markersize = 6)

        # add coastlines
        lines!(ax, GeoMakie.coastlines(), color=:black) 
    end

    # add colorbar
    Colorbar(fig[1,4], colorrange = (sigma_q05,sigma_q95), label=&quot;dB&quot;)

    fig
end</code></pre><p><img src="../subset_szr_plot.png" alt="Subset SZR plot"/></p><p>The subset shows the measured backscatter from the right swath over the mediterranean and across Italy. The red spots shows the measurements flagged as &quot;bad&quot;. This is probably caused by radio frequency interference from ground equipment resulting in a low signal-to-noise ratio.</p><h2 id="Soil-moisture-example"><a class="docs-heading-anchor" href="#Soil-moisture-example">Soil moisture example</a><a id="Soil-moisture-example-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-moisture-example" title="Permalink"></a></h2><p>The ASCAT Level 2 SMR product contains relative soil moisture on a 12.5 x 12.5 km grid. The SMO product is identical but resampled to a 25 x 25 km grid instead. See <a href="https://data.eumetsat.int/product/EO:EUM:DAT:METOP:SOMO12">ASCAT level 2 SMR product page</a> and <a href="https://data.eumetsat.int/product/EO:EUM:DAT:METOP:SOMO25">ASCAT level 2 SMO product page</a> for more information.</p><p>These examples will work to plot both SMR and SMO data. The examples are made using the following packages.</p><pre><code class="nohighlight hljs">[13f3f980] CairoMakie v0.12.16
[db073c08] GeoMakie v0.7.9</code></pre><h3 id="Plotting-a-subset-of-SMR-or-SMO"><a class="docs-heading-anchor" href="#Plotting-a-subset-of-SMR-or-SMO">Plotting a subset of SMR or SMO</a><a id="Plotting-a-subset-of-SMR-or-SMO-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-a-subset-of-SMR-or-SMO" title="Permalink"></a></h3><p>This example shows how to plot the soil moisture for from a SMR or SMO product.</p><pre><code class="language-julia hljs">using MetopDatasets
using CairoMakie, GeoMakie, Dates

ds = MetopDataset(&quot;ASCA_SMR_02_M01_20241217081500Z_20241217095658Z_N_O_20241217090845Z.nat&quot;, maskingvalue=NaN);

# Select subset record subset to plot
record_subset = 150:350

# define the two swaths. 
grid_nodes = ds.dim[&quot;xtrack&quot;]
swath_width = div(grid_nodes,2)
left_swath = 1:swath_width
right_swath = (swath_width+1):grid_nodes

# get sensing date
sensing_date = Date(DateTime(ds.attrib[&quot;sensing_start&quot;]))

# read variables for right_swath of the subset.
latitude = ds[&quot;latitude&quot;][right_swath, record_subset]
longitude = ds[&quot;longitude&quot;][right_swath, record_subset]
soil_moisture = ds[&quot;soil_moisture&quot;][right_swath, record_subset]

# change longitude to be -180 to 180
longitude[longitude .&gt; 180] .-= 360

fig = let    
    fig = Figure()

    # Create new axis
    ax = GeoAxis(fig[1, 1],
        title = &quot;Soil moisture $(sensing_date)&quot;,
        xlabel = &quot;longitude&quot;,
        ylabel = &quot;latitude&quot;,
        limits = (extrema(longitude), extrema(latitude))
        )

    # plot with scatter
    scatter!(ax, longitude[:], latitude[:], color=soil_moisture[:], colorrange=(0.0,100.0))

    # add coastlines
    lines!(ax, GeoMakie.coastlines(), color=:black) 
 
    # add colorbar
    Colorbar(fig[1,2], colorrange = (0.0,100.0), label=&quot;soil moisture %&quot;)

    fig
end</code></pre><p><img src="../subset_smr_plot.png" alt="Subset SZR plot"/> The plot shows the retrieved soil moisture. The filtering on flags in this example is very rough. It might be good to have a close look at the individual flag variables depending on the application.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../python/">« Use with Python</a><a class="docs-footer-nextpage" href="../IASI/">IASI »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Monday 7 April 2025 14:32">Monday 7 April 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
